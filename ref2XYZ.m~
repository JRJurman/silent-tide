function [ X, Y, Z ] = ref2XYZ( refs, cmfs, illum )
%REF2XYZ Summary of this function goes here
%   Detailed explanation goes here

cied = loadCIEData;
ref_lambda = 380:10:730;

k_bot = cmfs(:,2) .* illum * 5;
k = 100 / sum(k_bot);

% Resize the CMFs to match the ref data size
matches = ismember(cied.lambda, ref_lambda);
% matches(matches==0) = -1;

cmfs(matches,1)
cmfs(matches,2)

% tri_x_all = matches' .* cmfs(:,1);
% tri_x = find(tri_x_all ~= -1);
% tri_y_all = matches' .* cmfs(:,2);
% tri_y = tri_y_all(tri_y_all ~= -1);
% tri_z_all = matches' .* cmfs(:,3);
% tri_z = tri_z_all(tri_z_all ~= -1);

% size(tri_x)
% size(refs)
% size(10)

% X = k * sum(tri_x * refs * 10);
% Y = k * sum(tri_y * refs * 10);
% Z = k * sum(tri_z * refs * 10);

end

